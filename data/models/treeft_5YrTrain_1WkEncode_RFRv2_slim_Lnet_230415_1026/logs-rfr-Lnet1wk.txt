2023-04-15 10:26:36.981038: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.2023-04-15 10:26:36.983432: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.2023-04-15 10:26:37.042874: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.2023-04-15 10:26:37.043515: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.2023-04-15 10:26:38.038058: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRTGlobal seed set to 42Global seed set to 42GPU available: True (cuda), used: TrueTPU available: False, using: 0 TPU coresIPU available: False, using: 0 IPUsHPU available: False, using: 0 HPUs[rank: 0] Global seed set to 42Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/42023-04-15 10:27:29.678071: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT2023-04-15 10:27:29.732241: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT2023-04-15 10:27:29.747640: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[rank: 2] Global seed set to 42[rank: 1] Global seed set to 42[rank: 2] Global seed set to 42[rank: 1] Global seed set to 42[rank: 3] Global seed set to 42[rank: 3] Global seed set to 42[rank: 2] Global seed set to 42Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4[rank: 3] Global seed set to 42Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4[rank: 1] Global seed set to 42Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4----------------------------------------------------------------------------------------------------distributed_backend=ncclAll distributed processes registered. Starting with 4 processes----------------------------------------------------------------------------------------------------Missing logger folder: /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1026/lightning_logsMissing logger folder: /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1027/lightning_logsMissing logger folder: /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1027/lightning_logsMissing logger folder: /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1027/lightning_logsLOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]   | Name                               | Type                            | Params----------------------------------------------------------------------------------------0  | loss                               | QuantileLoss                    | 0     1  | logging_metrics                    | ModuleList                      | 0     2  | input_embeddings                   | MultiEmbedding                  | 403   3  | prescalers                         | ModuleDict                      | 5.1 K 4  | static_variable_selection          | VariableSelectionNetwork        | 820   5  | encoder_variable_selection         | VariableSelectionNetwork        | 1.4 M 6  | decoder_variable_selection         | VariableSelectionNetwork        | 1.3 M 7  | static_context_variable_selection  | GatedResidualNetwork            | 66.3 K8  | static_context_initial_hidden_lstm | GatedResidualNetwork            | 66.3 K9  | static_context_initial_cell_lstm   | GatedResidualNetwork            | 66.3 K10 | static_context_enrichment          | GatedResidualNetwork            | 66.3 K11 | lstm_encoder                       | LSTM                            | 132 K 12 | lstm_decoder                       | LSTM                            | 132 K 13 | post_lstm_gate_encoder             | GatedLinearUnit                 | 33.0 K14 | post_lstm_add_norm_encoder         | AddNorm                         | 256   15 | static_enrichment                  | GatedResidualNetwork            | 82.7 K16 | multihead_attn                     | InterpretableMultiHeadAttention | 41.2 K17 | post_attn_gate_norm                | GateAddNorm                     | 33.3 K18 | pos_wise_ff                        | GatedResidualNetwork            | 66.3 K19 | pre_output_gate_norm               | GateAddNorm                     | 33.3 K20 | output_layer                       | Linear                          | 903   ----------------------------------------------------------------------------------------3.5 M     Trainable params0         Non-trainable params3.5 M     Total params14.149    Total estimated model params size (MB)Data size: (4862712, 52)Data Columns: Index(['GPP_NT_VUT_REF', 'site_id', 'timestep_idx_local',       'timestep_idx_global', 'datetime', 'date', 'year', 'month', 'day',       'hour', 'TA_ERA', 'SW_IN_ERA', 'LW_IN_ERA', 'VPD_ERA', 'P_ERA',       'PA_ERA', 'EVI', 'NDVI', 'NIRv', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6',       'b7', 'IGBP', 'lat', 'long', 'koppen_sub', 'koppen_main', 'c3c4',       'c4_percent', 'BESS-PAR', 'BESS-PARdiff', 'BESS-RSDN', 'CSIF-SIFdaily',       'PET', 'Ts', 'ESACCI-sm', 'MODIS_LC', 'NDWI', 'Percent_Snow', 'Fpar',       'Lai', 'LST_Day', 'LST_Night', 'MODIS_IGBP', 'MODIS_PFT',       'gap_flag_hour', 'gap_flag_month', 'rfr_pred_gpp'],      dtype='object')NA count: 0Training timestemp length = 43800.Experiment logs saved to /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1026.Subest length: 43800 timesteps for each sitesSubset num train timesteps: 2579424Subset num val timesteps: 952752Number of parameters in network: 3537.3kSanity Checking: 0it [00:00, ?it/s]Data size: (4862712, 52)Data Columns: Index(['GPP_NT_VUT_REF', 'site_id', 'timestep_idx_local',       'timestep_idx_global', 'datetime', 'date', 'year', 'month', 'day',       'hour', 'TA_ERA', 'SW_IN_ERA', 'LW_IN_ERA', 'VPD_ERA', 'P_ERA',       'PA_ERA', 'EVI', 'NDVI', 'NIRv', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6',       'b7', 'IGBP', 'lat', 'long', 'koppen_sub', 'koppen_main', 'c3c4',       'c4_percent', 'BESS-PAR', 'BESS-PARdiff', 'BESS-RSDN', 'CSIF-SIFdaily',       'PET', 'Ts', 'ESACCI-sm', 'MODIS_LC', 'NDWI', 'Percent_Snow', 'Fpar',       'Lai', 'LST_Day', 'LST_Night', 'MODIS_IGBP', 'MODIS_PFT',       'gap_flag_hour', 'gap_flag_month', 'rfr_pred_gpp'],      dtype='object')NA count: 0Training timestemp length = 43800.Experiment logs saved to /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1027.Subest length: 43800 timesteps for each sitesSubset num train timesteps: 2579424Subset num val timesteps: 952752Number of parameters in network: 3537.3kData size: (4862712, 52)Data Columns: Index(['GPP_NT_VUT_REF', 'site_id', 'timestep_idx_local',       'timestep_idx_global', 'datetime', 'date', 'year', 'month', 'day',       'hour', 'TA_ERA', 'SW_IN_ERA', 'LW_IN_ERA', 'VPD_ERA', 'P_ERA',       'PA_ERA', 'EVI', 'NDVI', 'NIRv', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6',       'b7', 'IGBP', 'lat', 'long', 'koppen_sub', 'koppen_main', 'c3c4',       'c4_percent', 'BESS-PAR', 'BESS-PARdiff', 'BESS-RSDN', 'CSIF-SIFdaily',       'PET', 'Ts', 'ESACCI-sm', 'MODIS_LC', 'NDWI', 'Percent_Snow', 'Fpar',       'Lai', 'LST_Day', 'LST_Night', 'MODIS_IGBP', 'MODIS_PFT',       'gap_flag_hour', 'gap_flag_month', 'rfr_pred_gpp'],      dtype='object')NA count: 0Training timestemp length = 43800.Experiment logs saved to /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1027.Subest length: 43800 timesteps for each sitesSubset num train timesteps: 2579424Subset num val timesteps: 952752Number of parameters in network: 3537.3kData size: (4862712, 52)Data Columns: Index(['GPP_NT_VUT_REF', 'site_id', 'timestep_idx_local',       'timestep_idx_global', 'datetime', 'date', 'year', 'month', 'day',       'hour', 'TA_ERA', 'SW_IN_ERA', 'LW_IN_ERA', 'VPD_ERA', 'P_ERA',       'PA_ERA', 'EVI', 'NDVI', 'NIRv', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6',       'b7', 'IGBP', 'lat', 'long', 'koppen_sub', 'koppen_main', 'c3c4',       'c4_percent', 'BESS-PAR', 'BESS-PARdiff', 'BESS-RSDN', 'CSIF-SIFdaily',       'PET', 'Ts', 'ESACCI-sm', 'MODIS_LC', 'NDWI', 'Percent_Snow', 'Fpar',       'Lai', 'LST_Day', 'LST_Night', 'MODIS_IGBP', 'MODIS_PFT',       'gap_flag_hour', 'gap_flag_month', 'rfr_pred_gpp'],      dtype='object')NA count: 0Training timestemp length = 43800.Experiment logs saved to /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1027.Subest length: 43800 timesteps for each sitesSubset num train timesteps: 2579424Subset num val timesteps: 952752Number of parameters in network: 3537.3kSanity Checking:   0%|                                                                                  | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|                                                                     | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|██████████████████████████████▌                              | 1/2 [00:00<00:00,  2.14it/s]Sanity Checking DataLoader 0: 100%|█████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.51it/s]                                                                                                                              Training: 0it [00:00, ?it/s]Training:   0%|                                                                                     | 0/13729 [00:00<?, ?it/s]Epoch 0:   0%|                                                                                      | 0/13729 [00:00<?, ?it/s][W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())Training time: 13267.213766996Best model path: /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1026/epoch=1-step=20048.ckptSaved model to /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRv2_slim_Lnet_230415_1026/model.pth