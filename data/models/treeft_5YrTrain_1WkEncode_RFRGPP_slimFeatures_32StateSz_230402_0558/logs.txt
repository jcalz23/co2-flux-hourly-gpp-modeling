2023-04-02 05:57:14.357768: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.2023-04-02 05:57:14.360071: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.2023-04-02 05:57:14.405368: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.2023-04-02 05:57:14.405849: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.2023-04-02 05:57:15.063909: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRTGlobal seed set to 42Global seed set to 42GPU available: True (cuda), used: TrueTPU available: False, using: 0 TPU coresIPU available: False, using: 0 IPUsHPU available: False, using: 0 HPUs[rank: 0] Global seed set to 42Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/42023-04-02 05:58:04.538842: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT2023-04-02 05:58:04.538863: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT2023-04-02 05:58:04.538878: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[rank: 3] Global seed set to 42[rank: 3] Global seed set to 42[rank: 2] Global seed set to 42[rank: 2] Global seed set to 42[rank: 1] Global seed set to 42[rank: 1] Global seed set to 42[rank: 3] Global seed set to 42Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4[rank: 2] Global seed set to 42Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4[rank: 1] Global seed set to 42Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4----------------------------------------------------------------------------------------------------distributed_backend=ncclAll distributed processes registered. Starting with 4 processes----------------------------------------------------------------------------------------------------LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3]LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3]LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3]   | Name                               | Type                            | Params----------------------------------------------------------------------------------------0  | loss                               | QuantileLoss                    | 0     1  | logging_metrics                    | ModuleList                      | 0     2  | input_embeddings                   | MultiEmbedding                  | 403   3  | prescalers                         | ModuleDict                      | 832   4  | static_variable_selection          | VariableSelectionNetwork        | 244   5  | encoder_variable_selection         | VariableSelectionNetwork        | 65.9 K6  | decoder_variable_selection         | VariableSelectionNetwork        | 59.2 K7  | static_context_variable_selection  | GatedResidualNetwork            | 4.3 K 8  | static_context_initial_hidden_lstm | GatedResidualNetwork            | 4.3 K 9  | static_context_initial_cell_lstm   | GatedResidualNetwork            | 4.3 K 10 | static_context_enrichment          | GatedResidualNetwork            | 4.3 K 11 | lstm_encoder                       | LSTM                            | 8.4 K 12 | lstm_decoder                       | LSTM                            | 8.4 K 13 | post_lstm_gate_encoder             | GatedLinearUnit                 | 2.1 K 14 | post_lstm_add_norm_encoder         | AddNorm                         | 64    15 | static_enrichment                  | GatedResidualNetwork            | 5.3 K 16 | multihead_attn                     | InterpretableMultiHeadAttention | 4.2 K 17 | post_attn_gate_norm                | GateAddNorm                     | 2.2 K 18 | pos_wise_ff                        | GatedResidualNetwork            | 4.3 K 19 | pre_output_gate_norm               | GateAddNorm                     | 2.2 K 20 | output_layer                       | Linear                          | 231   ----------------------------------------------------------------------------------------179 K     Trainable params0         Non-trainable params179 K     Total params0.718     Total estimated model params size (MB)Data size: (4862712, 52)Data Columns: Index(['GPP_NT_VUT_REF', 'site_id', 'timestep_idx_local',       'timestep_idx_global', 'datetime', 'date', 'year', 'month', 'day',       'hour', 'TA_ERA', 'SW_IN_ERA', 'LW_IN_ERA', 'VPD_ERA', 'P_ERA',       'PA_ERA', 'EVI', 'NDVI', 'NIRv', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6',       'b7', 'IGBP', 'lat', 'long', 'koppen_sub', 'koppen_main', 'c3c4',       'c4_percent', 'BESS-PAR', 'BESS-PARdiff', 'BESS-RSDN', 'CSIF-SIFdaily',       'PET', 'Ts', 'ESACCI-sm', 'MODIS_LC', 'NDWI', 'Percent_Snow', 'Fpar',       'Lai', 'LST_Day', 'LST_Night', 'MODIS_IGBP', 'MODIS_PFT',       'gap_flag_hour', 'gap_flag_month', 'rfr_pred_gpp'],      dtype='object')NA count: 0Experiment logs saved to /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRGPP_slimFeatures_32StateSz_230402_0557.Number of parameters in network: 179.5kSanity Checking: 0it [00:00, ?it/s]Data size: (4862712, 52)Sanity Checking:   0%|                                                                                                                                                                                                           | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|                                                                                                                                                                                              | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:  50%|███████████████████████████████████████████████████████████████████████████████████████████                                                                                           | 1/2 [00:00<00:00,  1.78it/s]Sanity Checking DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.93it/s]Training: 0it [00:00, ?it/s]Training:   0%|                                                                                                                                                                                                               | 0/7545 [00:00<?, ?it/s]Epoch 0:   0%|                                                                                                                                                                                                                | 0/7545 [00:00<?, ?it/s][W reducer.cpp:1298] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())Epoch 0:   0%|                                                                                                                                                          | 1/7545 [00:05<11:47:48,  5.63s/it, loss=2.95, v_num=4, train_loss_step=2.950]Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2055/2055 [01:57<00:00, 17.48it/s]Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7545/7545 [18:14<00:00,  6.89it/s, loss=0.92, v_num=4, train_loss_step=0.912, val_loss=1.180, train_loss_epoch=1.030]Epoch 1:   0%|                                                                                                                  | 1/7545 [00:05<10:50:48,  5.18s/it, loss=0.92, v_num=4, train_loss_step=0.912, val_loss=1.180, train_loss_epoch=1.030]Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2055/2055 [01:57<00:00, 17.46it/s]Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7545/7545 [18:13<00:00,  6.90it/s, loss=0.81, v_num=4, train_loss_step=0.821, val_loss=1.190, train_loss_epoch=0.888]Epoch 2:   0%|                                                                                                                  | 1/7545 [00:05<11:13:46,  5.36s/it, loss=0.81, v_num=4, train_loss_step=0.821, val_loss=1.190, train_loss_epoch=0.888]Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2055/2055 [02:19<00:00, 14.71it/s]Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7545/7545 [20:17<00:00,  6.20it/s, loss=0.863, v_num=4, train_loss_step=0.936, val_loss=1.210, train_loss_epoch=0.865]Epoch 3:   0%|                                                                                                                 | 1/7545 [00:07<15:41:19,  7.49s/it, loss=0.863, v_num=4, train_loss_step=0.936, val_loss=1.210, train_loss_epoch=0.865]Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2055/2055 [02:20<00:00, 14.67it/s]Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7545/7545 [23:22<00:00,  5.38it/s, loss=0.801, v_num=4, train_loss_step=0.747, val_loss=1.250, train_loss_epoch=0.852]Epoch 4:   0%|                                                                                                                 | 1/7545 [00:07<15:17:19,  7.30s/it, loss=0.801, v_num=4, train_loss_step=0.747, val_loss=1.250, train_loss_epoch=0.852]Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2055/2055 [01:57<00:00, 17.43it/s]Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7545/7545 [19:52<00:00,  6.33it/s, loss=0.848, v_num=4, train_loss_step=0.786, val_loss=1.200, Epoch 5:   0%|                                                                                                                 | 1/7545 [00:05<11:23:19,  5.43s/it, loss=0.848, v_num=4, train_loss_step=0.786, val_loss=1.200, train_loss_epoch=0.844]Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2055/2055 [01:57<00:00, 17.44it/s]Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7545/7545 [18:14<00:00,  6.90it/s, loss=0.891, v_num=4, train_loss_step=0.982, val_loss=1.250, train_loss_epoch=0.831]Epoch 6:   0%|                                                                                                                 | 1/7545 [00:05<11:35:53,  5.53s/it, loss=0.891, v_num=4, train_loss_step=0.982, val_loss=1.250, train_loss_epoch=0.831]Validation DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2055/2055 [01:57<00:00, 17.44it/s]Epoch 6: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7545/7545 [18:13<00:00,  6.90it/s, loss=0.834, v_num=4, train_loss_step=0.936, val_loss=1.270, train_loss_epoch=0.828]Training time: 8199.492011309Best model path: /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRGPP_slimFeatures_32StateSz_230402_0558/version_0/checkpoints/epoch=6-step=38430.ckptSaved model to /root/co2-flux-hourly-gpp-modeling/data/models/treeft_5YrTrain_1WkEncode_RFRGPP_slimFeatures_32StateSz_230402_0558/model.pth